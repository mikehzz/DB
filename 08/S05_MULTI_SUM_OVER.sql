--panmae 테이블을 사용하여 제품코드, 판매점, 판매날짜, 판매량, 판매금액과
--판매점별로 누적 판매 금액을 구하세요.

SELECT  p_date,
        p_code,
        p_store,
        p_qty,
        p_total,
        SUM(p_total) OVER(PARTITION BY p_code,p_store ORDER BY p_date) "TOTAL"
FROM panmae
;  
P_DATE       P_CODE P_STO      P_QTY    P_TOTAL      TOTAL
-------- ---------- ----- ---------- ---------- ----------
20110101        100 1000           3       2400       2400
20110103        100 1000           2       1600       4000
20110103        100 1001           3       2400       2400
20110104        100 1002           2       1600       1600
20110104        100 1003           4       3200       3200
20110103        100 1004          10       8000       8000
20110104        100 1004           5       4000      12000
20110101        101 1001           5       4500       4500
20110104        101 1001           3       2700       7200
20110104        101 1002           4       3600       3600
20110103        101 1003           4       3600       3600

P_DATE       P_CODE P_STO      P_QTY    P_TOTAL      TOTAL
-------- ---------- ----- ---------- ---------- ----------
20110104        101 1003           3       2700       6300
20110102        102 1000           2       2000       2000
20110104        102 1001           4       4000       4000
20110104        102 1002           2       2000       2000
20110101        102 1003           2       2000       2000
20110102        103 1002           5       4500       4500
20110104        103 1003           2       1800       1800
20110101        103 1004           6       5400       5400
20110102        104 1002           3       2400       2400
20110102        105 1000           2       3000       3000

21개 행이 선택되었습니다. 